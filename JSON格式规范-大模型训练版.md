# ç…¤çŸ¿é‡‡ç©ºåŒºæ•°æ®é›† - JSONæ ¼å¼è§„èŒƒï¼ˆå¤§æ¨¡å‹è®­ç»ƒç‰ˆï¼‰

## ğŸ¯ è®¾è®¡åŸåˆ™

### ä¸€ä¸ªçŸ¿ä¸€ä¸ªJSONæ–‡ä»¶

**åŸå› **:
1. âœ… **å®Œæ•´ä¸Šä¸‹æ–‡** - ä¿ç•™é‡‡ç©ºåŒºå„è¦ç´ ä¹‹é—´çš„å…³è”å…³ç³»
2. âœ… **ä¸šåŠ¡è¾¹ç•Œæ¸…æ™°** - ç¬¦åˆ"ä¸€ä¸ªç…¤çŸ¿"çš„è‡ªç„¶è¾¹ç•Œ
3. âœ… **ä¾¿äºæ¨¡å‹å­¦ä¹ ** - æ¨¡å‹èƒ½å­¦ä¹ è¡¨ä¸è¡¨ä¹‹é—´çš„å…³ç³»
4. âœ… **æ˜“äºç®¡ç†** - æ·»åŠ æ–°ç…¤çŸ¿åªéœ€æ–°å¢æ–‡ä»¶
5. âœ… **ä¾¿äºé‡‡æ ·** - è®­ç»ƒæ—¶å¯æŒ‰ç…¤çŸ¿é‡‡æ ·

---

## ğŸ“‹ JSONç»“æ„

### é¡¶å±‚ç»“æ„

```json
{
  "mine_info": {...},      // ç…¤çŸ¿åŸºæœ¬ä¿¡æ¯
  "statistics": {...},     // æ•°æ®ç»Ÿè®¡
  "data": {...}            // 10ä¸ªè¡¨çš„æ•°æ®
}
```

### å®Œæ•´ç¤ºä¾‹

```json
{
  "mine_info": {
    "mine_id": "HX001",
    "mine_name": "æ²³è¥¿è”åŠç…¤çŸ¿",
    "survey_date": "2024å¹´",
    "standard": "KAT 22.2-2024",
    "data_version": "1.0.0"
  },
  
  "statistics": {
    "goaf_basic_info": 30,
    "goaf_water_info": 17,
    "goaf_gas_info": 124,
    "fire_info": 0,
    "suspended_roof_info": 10,
    "collapse_info": 0,
    "crack_info": 10,
    "abandoned_shaft_info": 2,
    "seal_wall_info": 25,
    "treatment_info": 4
  },
  
  "data": {
    "goaf_basic_info": [
      {
        "mine_id": "HX001",
        "mine_name": "æ²³è¥¿è”åŠç…¤çŸ¿",
        "goaf_id": "HX001-G001",
        "goaf_name": "é‡‡ç©º1",
        "coal_seam": "3-1",
        "mining_method": "æˆ¿æŸ±å¼",
        "goaf_area": 298,
        "area_unit": "kmÂ²",
        ...
      }
    ],
    
    "goaf_water_info": [
      {
        "water_id": "HX001-W001",
        "goaf_id": "HX001-G005",
        "water_number": "B3-1",
        "water_type": "é‡‡ç©ºåŒºç§¯æ°´",
        ...
      }
    ],
    
    "goaf_gas_info": [...],
    "fire_info": [...],
    "suspended_roof_info": [...],
    "collapse_info": [...],
    "crack_info": [...],
    "abandoned_shaft_info": [...],
    "seal_wall_info": [...],
    "treatment_info": [...]
  }
}
```

---

## ğŸ“Š å­—æ®µæ˜ å°„

### è¡¨åæ˜ å°„ï¼ˆä¸­æ–‡ â†’ è‹±æ–‡ï¼‰

| ä¸­æ–‡è¡¨å | è‹±æ–‡å­—æ®µå | è¯´æ˜ |
|---------|-----------|------|
| é‡‡ç©ºåŒºåŸºæœ¬ä¿¡æ¯ | goaf_basic_info | é‡‡ç©ºåŒºåŸºç¡€æ•°æ® |
| é‡‡ç©ºåŒºç§¯æ°´ä¿¡æ¯ | goaf_water_info | ç§¯æ°´ç›¸å…³æ•°æ® |
| é‡‡ç©ºåŒºç§¯æ°”ä¿¡æ¯ | goaf_gas_info | æ°”ä½“ç›‘æµ‹æ•°æ® |
| è‡ªç‡ƒå‘ç«ä¿¡æ¯ | fire_info | ç«åŒºç›¸å…³æ•°æ® |
| é‡‡ç©ºåŒºæ‚¬é¡¶ä¿¡æ¯ | suspended_roof_info | æ‚¬é¡¶ç›¸å…³æ•°æ® |
| é‡‡ç©ºåŒºå¡Œé™·ä¿¡æ¯ | collapse_info | å¡Œé™·ç›¸å…³æ•°æ® |
| åœ°è£‚ç¼ä¿¡æ¯ | crack_info | è£‚ç¼ç›¸å…³æ•°æ® |
| åºŸå¼ƒäº•ç­’ä¿¡æ¯ | abandoned_shaft_info | äº•ç­’ç›¸å…³æ•°æ® |
| å¯†é—­å¢™ä¿¡æ¯ | seal_wall_info | å¯†é—­å¢™ç›¸å…³æ•°æ® |
| é‡‡ç©ºåŒºæ²»ç†ä¿¡æ¯ | treatment_info | æ²»ç†å·¥ç¨‹æ•°æ® |

---

## ğŸ”§ è½¬æ¢å·¥å…·ä½¿ç”¨

### å®‰è£…ä¾èµ–

```bash
pip install pandas
```

### è½¬æ¢å•ä¸ªç…¤çŸ¿

```python
from CSVè½¬JSONå·¥å…· import MineDatasetConverter

# åˆ›å»ºè½¬æ¢å™¨
converter = MineDatasetConverter("HX001", data_dir=".")

# è½¬æ¢ä¸ºJSON
converter.convert_to_json("HX001-é‡‡ç©ºåŒºæ•°æ®é›†.json")
```

### æ‰¹é‡è½¬æ¢

```python
# æ‰¹é‡è½¬æ¢å¤šä¸ªç…¤çŸ¿
mine_codes = ["HX001", "SB001", "WCH001"]
converter = MineDatasetConverter("", data_dir=".")
converter.batch_convert(mine_codes, output_dir="./json_output")
```

---

## ğŸ“ æ–‡ä»¶ç»„ç»‡

### æ¨èç›®å½•ç»“æ„

```
dataset/
â”œâ”€â”€ raw/                          # åŸå§‹CSVæ–‡ä»¶
â”‚   â”œâ”€â”€ HX001-é‡‡ç©ºåŒºåŸºæœ¬ä¿¡æ¯.csv
â”‚   â”œâ”€â”€ HX001-é‡‡ç©ºåŒºç§¯æ°´ä¿¡æ¯.csv
â”‚   â””â”€â”€ ...
â”œâ”€â”€ json/                         # è½¬æ¢åçš„JSONæ–‡ä»¶
â”‚   â”œâ”€â”€ HX001-é‡‡ç©ºåŒºæ•°æ®é›†.json
â”‚   â”œâ”€â”€ SB001-é‡‡ç©ºåŒºæ•°æ®é›†.json
â”‚   â””â”€â”€ WCH001-é‡‡ç©ºåŒºæ•°æ®é›†.json
â”œâ”€â”€ train/                        # è®­ç»ƒé›†
â”‚   â”œâ”€â”€ HX001-é‡‡ç©ºåŒºæ•°æ®é›†.json
â”‚   â””â”€â”€ ...
â”œâ”€â”€ val/                          # éªŒè¯é›†
â”‚   â””â”€â”€ ...
â””â”€â”€ test/                         # æµ‹è¯•é›†
    â””â”€â”€ ...
```

---

## ğŸ“ å¤§æ¨¡å‹è®­ç»ƒå»ºè®®

### 1. æ•°æ®åˆ’åˆ†

```python
# æŒ‰ç…¤çŸ¿åˆ’åˆ†è®­ç»ƒ/éªŒè¯/æµ‹è¯•é›†
train_mines = ["HX001", "SB001", ...]  # 70%
val_mines = ["WCH001", ...]            # 15%
test_mines = ["XXX001", ...]           # 15%
```

### 2. æ•°æ®å¢å¼º

- âœ… ä¿æŒä¸€ä¸ªç…¤çŸ¿çš„å®Œæ•´æ€§
- âœ… å¯ä»¥å¯¹å•ä¸ªç…¤çŸ¿å†…çš„è®°å½•è¿›è¡Œé‡‡æ ·
- âœ… å¯ä»¥ç”Ÿæˆé—®ç­”å¯¹ï¼ˆåŸºäºè¡¨é—´å…³ç³»ï¼‰

### 3. è®­ç»ƒä»»åŠ¡

**ä»»åŠ¡1: ä¿¡æ¯æŠ½å–**
```
è¾“å…¥: æ²³è¥¿è”åŠç…¤çŸ¿çš„é‡‡ç©ºåŒºåŸºæœ¬ä¿¡æ¯
è¾“å‡º: æå–é‡‡ç©ºåŒºæ•°é‡ã€ç…¤å±‚ã€å¼€é‡‡æ–¹å¼ç­‰
```

**ä»»åŠ¡2: å…³ç³»æ¨ç†**
```
è¾“å…¥: é‡‡ç©ºåŒºG001çš„åŸºæœ¬ä¿¡æ¯
è¾“å‡º: æ¨ç†è¯¥é‡‡ç©ºåŒºçš„ç§¯æ°´æƒ…å†µã€æ°”ä½“ç›‘æµ‹ç»“æœç­‰
```

**ä»»åŠ¡3: é£é™©è¯„ä¼°**
```
è¾“å…¥: å®Œæ•´çš„ç…¤çŸ¿æ•°æ®
è¾“å‡º: è¯„ä¼°é‡‡ç©ºåŒºçš„é£é™©ç­‰çº§
```

---

## ğŸ’¡ ä¼˜åŠ¿åˆ†æ

### vs å¤šä¸ªJSONæ–‡ä»¶

| ç»´åº¦ | ä¸€ä¸ªçŸ¿ä¸€ä¸ªJSON | å¤šä¸ªè¡¨å¤šä¸ªJSON |
|------|---------------|---------------|
| **ä¸Šä¸‹æ–‡å­¦ä¹ ** | â­â­â­â­â­ å®Œæ•´ | â­â­ ç¢ç‰‡åŒ– |
| **å…³ç³»å­¦ä¹ ** | â­â­â­â­â­ è‡ªç„¶ | â­â­ éœ€è¦æ‹¼æ¥ |
| **æ•°æ®ç®¡ç†** | â­â­â­â­â­ ç®€å• | â­â­â­ å¤æ‚ |
| **é‡‡æ ·ç­–ç•¥** | â­â­â­â­â­ çµæ´» | â­â­â­ å—é™ |
| **æ¨¡å‹ç†è§£** | â­â­â­â­â­ ç›´è§‚ | â­â­â­ æŠ½è±¡ |

---

## ğŸ“ æ•°æ®è´¨é‡ä¿è¯

### 1. å®Œæ•´æ€§æ£€æŸ¥

```python
def check_completeness(json_data):
    """æ£€æŸ¥æ•°æ®å®Œæ•´æ€§"""
    required_tables = [
        "goaf_basic_info",
        "goaf_water_info",
        "goaf_gas_info",
        ...
    ]
    
    for table in required_tables:
        if table not in json_data["data"]:
            print(f"âŒ ç¼ºå°‘è¡¨: {table}")
        elif len(json_data["data"][table]) == 0:
            print(f"âš ï¸ è¡¨ä¸ºç©º: {table}")
```

### 2. å…³ç³»ä¸€è‡´æ€§æ£€æŸ¥

```python
def check_relationships(json_data):
    """æ£€æŸ¥å¤–é”®å…³ç³»"""
    goaf_ids = {item["goaf_id"] for item in json_data["data"]["goaf_basic_info"]}
    
    for water in json_data["data"]["goaf_water_info"]:
        if water["goaf_id"] and water["goaf_id"] not in goaf_ids:
            print(f"âŒ å¤–é”®é”™è¯¯: {water['water_id']}")
```

---

## ğŸ¯ æœ€ä½³å®è·µ

### 1. æ–‡ä»¶å‘½å

```
{mine_code}-é‡‡ç©ºåŒºæ•°æ®é›†.json

ç¤ºä¾‹:
- HX001-é‡‡ç©ºåŒºæ•°æ®é›†.json
- SB001-é‡‡ç©ºåŒºæ•°æ®é›†.json
- WCH001-é‡‡ç©ºåŒºæ•°æ®é›†.json
```

### 2. æ•°æ®ç»„ç»‡

- âœ… ä¸€ä¸ªç…¤çŸ¿ä¸€ä¸ªJSONæ–‡ä»¶
- âœ… ä¿æŒè¡¨çš„é¡ºåºä¸€è‡´
- âœ… ä½¿ç”¨ç»Ÿä¸€çš„å­—æ®µå
- âœ… ç©ºå€¼ä½¿ç”¨nullè€Œä¸æ˜¯ç©ºå­—ç¬¦ä¸²

### 3. ç‰ˆæœ¬ç®¡ç†

```json
{
  "mine_info": {
    "data_version": "1.0.0",
    "schema_version": "1.0.0",
    "update_date": "2024-12-26"
  }
}
```

---

## ğŸ“š å‚è€ƒèµ„æ–™

- **Schemaå®šä¹‰**: ç…¤çŸ¿é‡‡ç©ºåŒºæ™®æŸ¥æ•°æ®é›†Schema.json
- **è½¬æ¢å·¥å…·**: CSVè½¬JSONå·¥å…·.py
- **æ ‡å‡†æ–‡æ¡£**: KAT 22.2-2024

---

**ç‰ˆæœ¬**: 1.0.0  
**æ›´æ–°æ—¥æœŸ**: 2024-12-26  
**ç»´æŠ¤å•ä½**: ç…¤çŸ¿é‡‡ç©ºåŒºæ™®æŸ¥æ•°æ®æ ‡å‡†åŒ–å·¥ä½œç»„

